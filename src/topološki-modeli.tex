\section{Topološki modeli}

% Teorija modelov morda zveni kot zelo abstraktna in filozofska zadeva (govora je
% o matematičnih svetovih), vendar je pa ideja sama blizu vsakemu matematiku, ki
% je dokončal drugi letnik dodiplomskega študija.
% Situacija je namreč zelo podobna teoriji grup. Struktura grupe je skupek
% aksiomov (tako kot jih ima konstruktivna logika ali pa teorija množic), medtem
% ko so pa grupe same natanko \emph{modeli} teh aksiomov, in na model logike
% mislimo na isti način.

% Seveda pa grupe niso edina struktura, za katero lahko izvedemo to analogijo.
% Lahko tudi gledamo modele monoidne, kolobarske, vektorske,~itd.~strukture, prav
% tako pa lahko gledamo modele topološke strukture ali pa modele izračunljivostne
% strukture (recimo turingove stroje).

% V logiki in teoriji množic, se pogosto sprašujemo, ali so kakšne trditve
% \emph{neodvisne} od aksiomov našega sistema. Na primer aksiom izbire je
% neodvisen od preostalih aksiomov teorije množic, hipoteza kontinuuma je
% neodvisna od teorije množic z izbiro,~itd. Neodvisnost je mogoče malce
% nedostopen pojem, še posebej za matematike, ki verjamejo v absolutno resnico.
% Namreč, kako lahko trditev ni niti resnična niti neresnična? Ampak bistvo je v
% tem, da trditev ima resničnostno vrednost \emph{v vseh modelih}, vendar če je ta
% resničnostna vrednost različna v različnih modelih, je trditvi ne moremo
% dodeliti, tako da bo bilo to res v vseh modelih! Ključno je namreč, da noben
% model logike ni \emph{odlikovan}, torej nimamo \quot{standardnega modela}.

% To se vse sliši nekoliko komplicirano, a nam je zares že intimno znano. V
% teoriji grup namreč vemo za \quot{komutativnost}, za katero vemo, da se je ne da
% dokazati iz aksiomov grupe, prav tako pa ne velja njena negacija. To pa vemo
% natanko zato, ker obstajajo in komutativne in nekomutativne grupe (oziroma
% modeli aksiomov grup). V teoriji grup prav tako nimamo \quot{standardne grupe},
% za katero velja natanko vse kar velja za vse grupe.

% V logiki takim stvarem pravimo \quot{neodvisne trditve}, v teoriji
% izračunljivosti tem pravimo \quot{neizračunljive funkcije}, v algebri in
% topologiji pa \quot{lastnosti algebraične strukture oz.~topološkega prostora}.

% Skratka, prehod med aksiomatskim sistemom in modeli nam je kot matematikom znan,
% v algebri smo bili z njim vzgojeni že od malega, a v logiki te sreče žal nismo
% imeli. Tako se moramo na stara leta pruičiti teh metod, ki so pa logikom brez
% dvoma enako pomembne kot so grupe algebrajikom, ali pa prostori topologom.

% Kot smo pa omenili v uvodu, pa obstajajo modeli logike, ki so zgrajeni iz
% topoloških prostorov. Tem pravimo topološki modeli, in vse logične trditve v tem
% modelu se prevedejo v topološke trditve o topološkem prostoru. Sledi naravno
% vprašanje, ali lahko vzpostavimo nekak slovar med neodvisnimi trditvami
% (t.~j.~klasičnimi principi v konstruktivni logiki) in topološkimi lastnostmi, ki
% so nam znane.

% Do tega se vrnemo kasneje, v naslednjem razdelku, za zdaj nas pa čaka malo
% teorije snopov, da lahko topološke modele sploh definiramo.

% TODO: rewrite

% Oglejmo si najprej primer zveznih funkcij iz \(X\) v \(ℝ\).
% Zanje se vedno lahko vprašamo, če so pozitivne, negativne, ali so gladke,
% ipd.~vendar nas pogosto zanima tudi \emph{kje} za določeno funkcijo neka
% lastnost velja. Recimo preprosto, da je \(f : ℝ → ℝ\) identiteta. Tedaj je
% pozitivna na \((0,∞)\), negativna na \((-∞,0)\), gladka pa na celem \(ℝ\).
% Klasično je pozitivnost funkcije resničnostna vrednost. Z drugimi besedami,
% pozitivnost je predikat na (zveznih) realnih funkcijah. Mi pa zares želimo
% opredeliti, kje ta lastnost velja, ne zgolj če velja na celem prostoru.
% Želimo torej, da ima ``prava'' pozitivnost vrednosti v podmnožicah prostora
% \(X\), in da bo imela topologija \(X\) kaj vpliva naj bodo to zgolj odprte
% podmnožice.

% Želimo pa tudi obravnavati funkcije, ki niso definirane na celotni domeni, na
% primer \(x ↦ x⁻¹\). Tako naš primer razširimo na množico vseh funkcij \(U → ℝ\),
% kjer je \(U ∈ 𝒪X\), in označimo množico vseh teh funkcij z \(R\). Potem pa za
% \(f ∈ R\) definiramo \emph{definicijsko območje} oziroma \emph{razpon} kot
% domeno funkcije \(f\), in ga označimo \(‖f‖\).
% Na to množico lahko sedaj uvedemo predikat enakosti, ki seveda meri, na kateri
% množici se dve funkciji ujemata, na očiten način:
% \[ ⟦f = g⟧ = \int\set{t ∈ ‖f‖∩‖g‖}{f(t) = g(t)}\text. \]

% Ni naključje, da preslikavam \(R → 𝒪X\) pravimo predikati, saj se da pokazati,
% da za vsako polno Heytingovo algebro (kar \(𝒪X\) je) obstaja nek model
% konstruktivne matematike, tako da so resničnostne vrednosti natanko odprte
% množice \(X\). V tem smislu \(⟦f = g⟧\) predstavlja kar enakost med funkcijami,
% \(‖f‖\) je pa predikat obstoja elementa \(‖f‖ = \exist{f : R}{⊤}\). Velja tudi
% enakost \(‖f‖ = ⟦f = f⟧\), torej zares predikata \(‖-‖\) ne potrebujemo.

% V splošnem, množicam kot so \(R\), torej takim, da imajo definirano enakost z
% vrednostmi v \(𝒪X\) pravimo \emph{Heytingovo vrednotene množice},
% \emph{\(𝒪X\) vrednotene množice}, ali na kratko \emph{\(𝒪X\)-množice}.

V tem razdelku najprej podrobno opišemo, kako interpretiramo logiko odprtih
množic v topološkem prostoru samem. Kasneje potem to logiko razširimo do logike
višjega reda.


\subsection{Logika odprtih množic}

Naj bo \(X\) topološki prostor. Podrobno si oglejmo kako logične operacije
delujejo v logiki odprtih množic.

Če odprto množico \(U ⊆ X\) interpretiramo kot ``resnično na \(U\)'', potem je
resnica kar ``renično povsod'', oziroma \(X\). Neresnica bi potem lahko bila
katera koli množica, ki ni \(X\), ampak raje vzamemo za neresnico \emph{strožji}
pogoj, ki pravi ``resnično nikjer'', torej prazna množica. To nam tudi namigne,
da princip izključene tretje možnosti v tej logiki ne bo veljal.

Oglejmo si sedaj kako logične operacije delajo za pozitivnost realnih funkcij.
Situacija v splošnem bo potem popolnoma enaka, ampak je na tem primeru
geometrijska slika malo bolj jasna. Naj bosta \(f\) in \(g\) funkciji \(X → ℝ\)
in \(U ≔ ⟦f > 0⟧\), torej množica kjer je \(f\) pozitivna, in podobno \(V ≔ ⟦g > 0⟧\).

V tem kontekstu je potem \(f > 0 = ⊤\) ko je \(U = X\), oziroma, ko \(f\)
pozitivna povsod, in \(f > 0 = ⊥\), ko je \(U = ∅\), oziroma, ko \(f\) ni
pozitivna nikjer. Ubistvu si želimo, da \(f > 0 = ⊥\) velja natanko tedaj, ko
negacija neenakosti, torej \(f ≤ 0\), velja na celem prostoru. Zato torej tudi
vzamemo kot neresnico prazno množico, in ne poljubno množico različno od \(X\),
saj nam to da najbolj uporabno interpretacijo logičnih formul. Prav tako nam
omogoča, da ločimo med funkcijami, ki niso pozitivne, in med nepozitivnimi
funkcijami, kar je v analizi dokaj pomembna razlika.

Konjunkcijo \(U ∧ V\) potem beremo kot ``funkciji \(f\) in \(g\) sta obe
pozitivni'', kar je res natanko na preseku množic \(U\) in \(V\). Podobno je
disjunkcija \(U ∨ V\) natanko unija \(U\) in \(V\).
Za negacijo moramo malo razmisliti. Izraz \(f > 0\) lahko preprosto negiramo, in
dobimo pogoj \(f ≤ 0\), ampak množica \(x ∈ X\) za katere to drži tudi ni odprta
(in je natanko komplement \(U\), kar bi bil drugi kandidat za negacijo \(U\)).
Ampak lahko pa vzamemo njeno notranjost, torej ``največjo odprto množico, na
kateri \(f > 0\) ne velja''. Temu se potem reče tudi ``zunanjost množice
\(U\)'', označeno \(\ext{U}\), iz angleško ``\foreignlanguage{english}{exterior}''.

Implikcije med množicama v običajni matematiki ponavadi ne vidimo, tako da nam
tudi naša geometrijska slika ne bo veliko pomagala. Implikacija med množicama
\(A, B ⊆ X\) se definira dokaj intuitivno kot \(\set{x ∈ X}{x ∈ A ⇒ x ∈ B}\).
V klasični metateoriji je potem ta množica kar enaka \(B ∪ Aᶜ\). Res,
implikacija zgoraj je natanko \(x ∈ B ∨ x ∉ A\), oziroma \(x ∈ B ∪ Aᶜ\). Ampak
ta množica za \(U\) in \(V\) ni nujno odprta, tako da moramo spet vzeti njeno
notranjost, torej \(U ⇒ V\) je \(\int{\p{V ∪ Uᶜ}}\).
Implikacijo bi lahko tudi definirali drugače, saj se izkaže, da je natanko
karakterizirana z naslednjo lemo.
\begin{lema}
  Za vsak \(W ∈ 𝒪X\) je \(W ⊆ U ⇒ V\) natanko tedaj, ko je \(W ∩ U ⊆ V\).
\end{lema}
\begin{proof}
  Najprej preoblikujmo desno vsebovanost, saj lahko rečemo da že na nivoju
  množic, velja, da je \(W ∩ U ⊆ V\) natanko tedaj, ko je \(W ⊆ V ∪ Uᶜ\).
  Potem je pa po definiciji \(U ⇒ V\) največja odprta podmnožica \(V ∪ Uᶜ\),
  tako da bo gornja ekvivalenca očitno veljala, v eno smer ker je
  \(U ⇒ V ⊆ V ∪ Uᶜ\), v drugo smer pa ker je to največja taka množica.
\end{proof}

V klasični matematiki se pogosto reče, da je implikacija \(U ⇒ V\) kar
definirana kot \(V ∨ ¬U\), torej \(V ∪ \int{\p{Uᶜ}}\), ampak to v tem primeru ne
drži, kar vemo tudi iz konstruktivne matematike. Res, pokažemo lahko, da če
velja \(U ⇒ V = V ∨ ¬U\), velja princip izključene tretje možnosti. Očitno si za
implikacijo želimo, da velja \(U ⇒ U\) za vse \(U\). Ampak če velja gornja
enakost, bi to pomenilo, da velja \(U ∨ ¬U\) za vse \(U\), kar je pa natanko
princip izključene tretje možnosti. Naj bo recimo \(X\) prostor Sierpinskijeva,
torej prostor z dvema točkama \(0\) in \(1\), kjer je zgolj točka \(1\) odprta.
Potem je pa negacija \(U ≔ \{1\}\) prazna množica, in je \(U ∨ ¬U = U ≠ X\).
Logika tega prostora torej ni klasična, in tam gornja enakost ne velja.
Imamo torej sledeči slovar:
\newcolumntype{C}{>{\centering\arraybackslash}X}
\begin{table}[h]
  \centering
  \begin{tabularx}{0.5\textwidth}{@{} *{2}{C} @{}}
    Logika    & Topologija\\
    \midrule
    \(⊤\)     & \(X\)\\
    \(⊥\)     & \(∅\)\\
    \(U ∧ V\) & \(U ∩ V\)\\
    \(U ∨ V\) & \(U ∪ V\)\\
    \(¬U\)    & \(\ext{U}\)\\
    \(U ⇒ V\) & \(\int{\p{V ∪ Uᶜ}}\)
  \end{tabularx}
  
  \caption{Slovar za logiko odprtih množic}
  \label{tab:logic-opens-dict}
\end{table}

V nadaljevanju bomo raje pisali logične simbole, razen kjer govorimo konkretno o
operacijah na točkah prostora. Glavni razlog za to je, da se želimo zanašati na
intuicijo iz logike, kar bo pomagalo pri razumevanju motivacije večine
definicij. Imamo pa še skrivni razlog za to, ki ga bomo razkrili kasneje.
To tudi pomeni, da bomo namesto \(⊆\) pisali \(≤\).

\begin{opomba}
  Ker je \(W∧U ≤ V\) natanko tedaj ko \(W ≤ U⇒V\), je \(U ≤ V\) natanko tedaj,
  ko velja \(⊤ = U⇒V\), torej ko je \(U⇒V\) \quot{res}. To pa pomeni, da na
  \(U ≤ V\) lahko gledamo kot \quot{iz \(U\) sledi \(V\)}.
\end{opomba}

S tem smo vsakemu prostoru priredili propozicijsko logiko, sedaj bi pa želeli
to logiko obogatiti do logike prvega (in nato višjega) reda.
Do neke mere lahko tudi povemo, kaj so kvantifikatorji v tej logiki, le da lahko
kvantificiramo zgolj po resničnostnih vrednostih.
Naj bo \(P\) predikat na \(𝒪X\). Izkaže se, da lahko te interpretiramo kot
funkcije tipa \(𝒪X → 𝒪X\).
Najprej, če želimo najti, na kateri množici je \(P\) res za vse \(U ∈ 𝒪X\),
moramo najti največjo odprto množico, ki je vsebovana v vsakem \(P(U)\), kar je
natanko notranjost preseka teh množic.
Obstoj je malo bolj kompliciran. Eventuelno bomo želeli, da velja na primer
\(U₀ ∨ U₁ = \exist{i∈2}{Uᵢ}\), kakor tudi velja v navadni logiki.
Ampak denimo, da je \(X = ℝ\), \(U₀ = \p{-∞, 1}\), in \(U₁ = \p{0, ∞}\).
Potem je \(U₀ ∨ U₁ = ℝ\), ampak ne obstaja noben \(i\), da bi bil \(Uᵢ = ℝ\).
Rešitev na to dilemo je, da je prava interpretacija obstoja kar unija vrednosti
\(Uᵢ\) pri vseh možnih vrednostih \(i\).

\begin{align*}
  \for{p : Ω}{P(p)}   &≔ \int{\parens[\bigg]{⋂_{U ∈ 𝒪X}P(U)}}\\
  \exist{p : Ω}{P(p)} &≔ ⋃_{U ∈ 𝒪X}P(U)
\end{align*}
% Zares bi lahko rekli tudi malo več. Če je \(A\) poljubna množica in \(P\)
% podobno kot zgoraj tipa \(A → 𝒪X\), lahko definiramo \(\for{a : \c A}{P(a)}\)
% kot \(\int{\p{⋂_{a ∈ A}P(a)}}\). Tu v bistvu množico \(A\) v našo logiko vložimo
% kot diskreten prostor (označen \(\c A\)), kar dela dobro za na primer množico
% naravnih števil, se pa izkaže, da za recimo realna števila ne deluje. Res,
% realna števila (v večini logik) ne bodo diskreten prostor! Si bomo pa vseeno
% podrobneje pogledali kdaj točno so, saj se izkaže, da ima to zanimive posledice.

Na tej točki smo že definirali dovolj logike, da karakteriziramo dva znana
principa: princip izključene tretje možnosti in DeMorganov zakon.
\begin{trditev}
  Nad topološkim prostorom velja princip izključene tretje možnosti natanko
  tedaj, ko je prostor \emph{particijski}, t.~j.~vsaka odprta množica je zaprta.
\end{trditev}
\begin{proof}
  Princip izključene tretje možnosti pravi, da velja formula
  \(\for{p : Ω}{p ∨ ¬p}\). Če to interpretiramo v logiki odprtih množic, dobimo
  pogoj, da mora za vsako odprto množico veljati, da je
  \(X = U ∨ ¬U = U ∪ \int{\p{Uᶜ}}\).

  Ampak opazimo, da bo \(U ∪ A\) enako celemu prostoru, mora biti \(A\) nujno
  enak komplementu \(U\). Tedaj pa mora veljati, da je \(Uᶜ = \int{\p{Uᶜ}}\),
  torej da je množica \(Uᶜ\) odprta, kar je pa natanko tedaj, ko je množica
  \(U\) zaprta.
\end{proof}

\begin{trditev}
  Nad topološkim prostorom velja DeMorganov zakon natanko tedaj, ko je prostor
  \emph{ekstremalno nepovezan}, torej, da je zaprtje vsake (odprte) množice odprto.
\end{trditev}
\begin{proof}
  DeMorganov zakon je ekvivalenten trditvi \(\for{p : Ω}{¬p ∨ ¬¬p}\), kar pa
  prav tako kot v gornjem dokazu pravi, da so vse zunanjosti množic zaprte.
  To pa pomeni, da so njihovi komplementi, torej zaprtja množic odprta, kar je
  natanko kar smo želeli.
\end{proof}


\subsection{Heytingovo-vrednotene množice}

Oglejmo si spet primer naravnih števil nad nekim prostorom \(X\). To bodo zvezne
preslikave iz odprtih podmnožic \(X\) v \(ℕ\).
Najprej, lahko vsaki taki preslikavi dodelimo ``resničnostno vrednost obstoja'',
oziroma \emph{razpon}, ki bo kar njena domena. To označimo z \(‖-‖\). Če je
\(n : U → ℕ\), potem \(n\) obstaja zgolj na \(U\), saj izven \(U\) nima
vrednosti. Različni taki naravni števili lahko tudi primerjamo, tako da
preprosto pogledamo množico, na kateri sta enaki: \(⟦n = m⟧ = \set{t ∈ X}{n(t) = m(t)}\),
kjer seveda pazimo, da \(t\) jemljemo zgolj iz razpona obeh števil.
Načeloma bi morali vzeti notranjost te množice, saj morajo biti resničnostne
vrednosti odprte, ampak v tem primeru, ker so funkcije lokalno konstantne, bo ta
množica odprta. Potem pa se izkaže, da če velja enakost \(⟦n = n⟧ = \dom(n)\),
tako da če znamo primerjati vsa števila, lahko izpeljemo tudi razpon, kar bomo
tudi vzeli kot osnovni gradnik naših objektov.

Označimo z \(ℒ\) topologijo prostora \(X\).
\begin{definicija}
  TODO: a naj bo ime \(ℒ\)-množice, ali dam kaj drugega? \(X\)-množice nočem
  zares, \(𝒪X\)-množice je malo nereodno, še posebej če nikjer nimam nobene
  točke in sight.

  \emph{\(ℒ\)-vrednotena množica} oziroma \emph{\(ℒ\)-množica} je množica \(A\),
  skupaj s preslikavo, ki jo pišemo \(⟦- = -⟧ : A×A → ℒ\), tako da velja
  \begin{align*}
    ⟦ a = b ⟧ ≤ ⟦ b = a ⟧\\
    ⟦ a = b ⟧ ∧ ⟦ b = c ⟧ ≤ ⟦ a = c ⟧
  \end{align*}
  Če iz konteksta ni razvidno kateri množici pripada preslikava \(⟦- = -⟧\),
  jo pišemo z indeksom \(⟦- =_A -⟧\).

  Kot zgoraj naj bo \(‖a‖ ≔ ⟦a = a⟧\) \emph{razpon \(a\)}.
\end{definicija}

Če \(≤\) beremo kot logično implikacijo, zgornja aksioma zgledata zelo podobno
aksiomoma simetričnosti in tranzitivnosti relacije \(=\), tako da bi lahko
rekli, da so \(ℒ\)-množice natanko množice opremljene z (interno) delno
ekvivalenčno relacijo.

\begin{primer}
  Na \(\set{f : U → ℕ}{U ∈ ℒ}\) lahko definiramo preslikavo
  \(⟦n = m⟧ = \set{t ∈ X}{n(t) = m(t)}\). To je \(ℒ\)-množica, ki jo bomo
  označili z \(𝒩\).
\end{primer}

Je pa ta struktura bistveno bolj splošna kot ``množica preslikav z enakostjo po
točkah''.

\begin{primer}
  Množica \(ℕ\) skupaj z enakostjo definirano kot
  \[ ⟦n = m⟧ ≔ \begin{cases} X &; n = m\\ ∅ &; n ≠ m \end{cases} \]
  je \(ℒ\)-množica. To bomo označevali z \(\c ℕ\).
\end{primer}

V tem primeru elementi množice očitno niso zvezne funkcije iz prostora.
To je zato, ker imajo zvezne funkcije še dve pomembni lastnosti, ki jih v
strukturi sami ne zajamemo.
Prvič, funkcije lahko zožamo. To preprosto pomeni, da če vrednost obstaja na
neki odprti množici, potem obstaja tudi na vsaki manjši odprti množici.
Drugič, če imamo družino zveznih funkcij, ki se paroma ujemajo na presekih
njihovih domen, jih lahko enolično zlepimo v zvezno funkcijo, definirano na
uniji njihovih domen. V primeru funkcij v naravna števila je ta lastnost zelo
zanimiva, saj je vsaka lokalno konstantna funkcija tak zlepek konstantnih
funkcij. Potem pa če to združimo še z zožitvami, lahko rečemo, da je vsaka
funkcija \(U → ℕ\) zlepek zožitev konstantnih funkcij \(X → ℕ\).
Tako lahko na nek način rečemo, da so zvezne funkcije v naravna števila
``generirane'' z množico naravnih števil samo.
To pa zares pomeni, da je \(𝒩\) nekakšna \emph{napolnitev} \(ℒ\)-množice \(Δℕ\).

Torej ne bomo zahtevali, da so naši objekti zaprti za zožitve in lepljenje, saj
jih lahko vedno napolnimo. Izkaže pa se, da nam to ustvari nekaj težav pri
definiciji funkcij. Želeli bi recimo, da je operacija zožitve preslikava, ampak
če \(ℒ\)-množice niso zaprte za zožitve, slike elementov preprosto ne nujno
obstajajo.

\begin{primer}
  Na primer, naj bo \(\p{2, 𝒫2}\) diskreten prostor na dveh točkah.
  \(𝒫2\)-množica \(A\) naj ima en element \(a\) definiran povsod,
  \(B\) pa dva elementa, \(b₀\) in \(b₁\), definirana v vsaki od točk prostora.
  Sedaj pa želimo definirati preslikavo, ki \(a\) slika v \(b₀\) na točki \(0\)
  in \(b₁\) na točki ena, pa naletimo natežavo, ker take funkcije ne moramo
  izraziti kot dejanska funkcija \(A → B\).
  Lahko pa definiramo relacijo, za katero za \(i ∈ 2\) velja \(R(a, bᵢ) ⇔ \{i\}\).
  Ta relacija je funkcijska, saj je \(2 = \{0\}∪\{1\} = R(a, b₀) ∨ R(a, b₁)\) in
  \(R(a, b) ∧ R(a, b') = ⟦b = b'⟧\).
\end{primer}

To nam da idejo, da lahko preslikave definiramo kot funkcijske relacije, seveda
spet vrednostene v logiki odprtih množic.

\begin{definicija}
  \emph{Morfizem med \(ℒ\)-množicama} \(A\) in \(B\) je preslikava \(⟦- = f(-)⟧ : B×A → ℒ\),
  za katero velja
  \begin{align}% TODO: change?
    &⟦b =_B b'⟧ ∧ ⟦b' = f(a)⟧ ≤ ⟦b = f(a)⟧    \tag{M1}\label{M1}\\
    &⟦b = f(a')⟧ ∧ ⟦a' =_A a⟧ ≤ ⟦b = f(a)⟧    \tag{M2}\label{M2}\\
    &⟦b = f(a)⟧ ∧ ⟦b' = f(a)⟧ ≤ ⟦b =_B b'⟧    \tag{M3}\label{M3}\\
    &‖a‖ = ⋁_{b ∈ B} ⟦b = f(a)⟧               \tag{M4}\label{M4}
  \end{align}
  Na prvi dve pravili gledamo kot na skladnost z relacijama na \(A\) in \(B\),
  na drugi dve sta pa enoličnost in celovitost, zato morfizme vseeno pišemo v
  funkcijskem zapisu kot \(f : A ↬ B\).
\end{definicija}
\begin{opomba}
  Podobnost med oklepaji je namerna, je pa vseeno vredno poudariti, da izraz
  \(⟦b = f(a)⟧\) ni povezan z izrazom \(⟦b =_B b'⟧\) nič več, kot lahko sklepamo
  iz gornjih aksiomov. Drugače rečeno, kljub temu, da na \(⟦b = f(a)⟧\) želimo
  gledati kot primerjavo slike \(a\) v \(ℒ\)-množici \(B\), se izraza vseeno
  bistveno razlikujeta, namreč v \(B\) ne obstaja nujno kak element, ki bi mu
  lahko rekli slika \(a\).
\end{opomba}
Vseeno pa v internem jeziku na \(⋁_{b ∈ B} φ(b)\) gledamo kot eksistenčni
kvantifikator, torej \ref{M4} res pravi, da obstaja nek \(b\), ki je slika
elementa \(a\), definicija kompozicije pa je potem natanko standardna
kompozicija relacij.

% Skupaj z identiteto \(⟦- =_A -⟧\), tvorijo \(ℒ\)-množice kategorijo, ki jo označimo \(\cat{Set}(ℒ)\).

\begin{konstrukcija}
  Če imamo morfizma \(A \oset{f}{↬} B \oset{g}{↬} C\), je njun kompozitum
  \(g∘f : A ↬ C\) definiran kot
  \[ ⟦c = g∘f(a)⟧ ≔ ⋁_{b ∈ B} ⟦c = g(b)⟧∧⟦b = f(a)⟧\text. \]
\end{konstrukcija}
\begin{proof}
  Pokazati moramo, da je tako definiran kompozitum res morfizem.
  TODO: končaj
\end{proof}

\begin{konstrukcija}
  Identiteta na \(A\) je kar \(⟦- =_A -⟧\).
\end{konstrukcija}
\begin{proof}
  TODO: končaj
\end{proof}

\begin{lema}
  Naj bosta \(f, g : A ↬ B\) morfizma. Potem sta enaka natanko tedaj, ko velja
  \[ \for{a ∈ A, b ∈ B}{ ⟦b = f(a)⟧ ≤ ⟦b = g(a)⟧ }.\]
\end{lema}
\begin{dokaz}
  V eno smer je trditev očitna, tako da predpostavimo, da za vsaka \(a\) in
  \(b\) velja \(⟦b = f(a)⟧ ≤ ⟦b = g(a)⟧\).
  Dokazati moramo torej, da velja tudi druga neenakost.
  \begin{align*}
    ⟦b = g(a)⟧
    &= ⟦b = g(a)⟧ ∧ ⟦a = a⟧ = ⟦b = g(a)⟧ ∧ \bigvee_{b' ∈ B} ⟦b' = f(a)⟧\\
    &= \bigvee_{b' ∈ B} ⟦b = g(a)⟧ ∧ ⟦b' = f(a)⟧ ∧ ⟦b' = g(a)⟧\\
    &≤ \bigvee_{b' ∈ B} ⟦b = b'⟧ ∧ ⟦b' = f(a)⟧ ≤ ⟦b = f(a)⟧.\qedhere
  \end{align*}
\end{dokaz}

Če na zgornjo formulo gledamo kot trditev v internem jeziku, bi se brala kot "če
je \(f(a) = b\) je potem tudi \(g(a) = b\)", kar pa ponavadi res pomeni, da sta
funkciji \(f\) in \(g\) enaki.

Na podoben način bi si želeli karakterizirati epimorfizme in monomorfizme v
kategoriji \(\cat{Set}(ℒ)\), in res jih lahko karakteriziramo kot surjekcije in
injekcije v tem jeziku:

TODO: spremeni to v definicijo, pokaži da je injektivnost ⇒ mono?
\begin{trditev}
  Morfizem \(f : A ↬ B\) je epimorfizem, če velja
  \[ \for{b ∈ B}{ ⟦b = b⟧ = ⋁_{a ∈ A} ⟦b = f(a)⟧ }\text, \]
  in monomorfizem, če velja % NOTE: A kvantificiram?
  \[ \for{a,a' ∈ A, b ∈ B}{ ⟦b = f(a)⟧ ∧ ⟦b = f(a')⟧ ≤ ⟦a = a'⟧}\text. \]
\end{trditev}
\begin{dokaz}
  % TODO: dokaz
  long and arduous
\end{dokaz}

Sedaj se pa želimo vprašati, kaj so bijekcije v kategoriji \(\cat{Set}(ℒ)\).
Že iz teorije množic vemo, da ima vsaka relacija dualno relacijo, ki se pa
obnaša kot nekakšen inverz. Za morfizem \(f : A ↬ B\) lahko definiramo dual
\(f⁻¹ : B ↬ A\) tako, da preprosto zamenjamo elementa v produktu.
Kompozituma z dualom pa sta res identiteti.

\begin{trditev}
  Za \(f : A ↬ B\) je \(f∘f⁻¹ = \id = f⁻¹∘f\).
\end{trditev}
\begin{dokaz}
  \begin{align*}
    ⟦b' = ff⁻¹(b)⟧
    &= ⋁_{a ∈ A} ⟦b' = f(a)⟧∧⟦a = f⁻¹(b)⟧\\
    &= ⋁_{a ∈ A} ⟦b' = f(a)⟧∧⟦b = f(a)⟧ ≤ ⟦b' = b⟧\\
    ⟦a' = f⁻¹f(a)⟧
    &= ⋁_{b ∈ B} ⟦a' = f⁻¹(b)⟧∧⟦b = f(a)⟧\\
    &= ⋁_{b ∈ V} ⟦a' = f⁻¹(b)⟧∧⟦a = f⁻¹(b)⟧ ≤ ⟦a' = a⟧\qedhere
  \end{align*}
\end{dokaz}

Ta dokaz zgleda, kot da pravi, da je vsak morfizem izomorfizem, vendar to očitno
ni res. In res, v zgornjem dokazu uporabimo, da je \(f⁻¹\) sploh morfizem
\(ℒ\)-množic. Prvima dvema aksiomoma je že zadoščeno, druga dva sta pa
ekvivalentna natanko injektivnosti in surjektivnosti \(f\).

Iz gornjega sicer zgleda, kot da potrebujemo zgolj injektivnost \(f\), vendar pa
morata biti tudi kompozituma \(ff⁻¹\) in \(f⁻¹f\) \(ℒ\)-morfizma, kjer se pa
skriva uporaba preostalih aksiomov.

Trditev se torej pravilno glasi tako:
\begin{trditev}
  Za \(f : A ↬ B\) je \(f⁻¹\) (morfizem in) inverz \(f\) natanko tedaj, ko je \(f\) bijektivna.
\end{trditev}

\subsubsection{Karakterizacija podobjektov}
NOTE: a je to svoj podrazdelek? zlo kratko je

Z uporabo gornje karakterizacije monomorfizmov, lahko karakteriziramo tudi podobjekte.
Kot vemo, so podobjekti natanko (ekvivalenčni razredi) monomorfizmov

\begin{definicija}
  \(ℒ\)-podmnožica \(A\) je preslikava \( ⟦- ∈ S⟧ : A → ℒ \), za katero velja
  \begin{align*}
    &⟦a ∈ S⟧ ≤ ⟦a = a⟧\\
    &⟦a = a'⟧ ∧ ⟦a' ∈ S⟧ ≤ ⟦a ∈ S⟧
  \end{align*}
  t.~j. je skladna z relacijo na \(A\). Pišemo tudi \(S ⊑ A\).
\end{definicija}
\begin{lema}
  Za \(ℒ\)-podmnožico \(S ⊑ A\) velja \(⟦a = a'⟧∧⟦a' ∈ S⟧ = ⟦a = a'⟧∧⟦a ∈ S⟧\).
\end{lema}

\begin{trditev}
  Obstaja ekvivalenca med delnima ureditvima \(ℒ\)-podmnožic \(A\) in podobjektov \(A\).
\end{trditev}
\begin{proof}
  Naj bo \(m : S ↬ A\) monomorfizem \(ℒ\)-množic.
  Potem definiramo preslikavo \( ⟦- ∈ m⟧ : A → ℒ \) s predpisom
  \(a ↦ ⋁_{s ∈ S} ⟦a = m(s)⟧\).

  Ta preslikava definira \(ℒ\)-množico, saj velja
  \begin{align*}
    &⟦a ∈ m⟧ = ⋁_{s ∈ S} ⟦a = m(s)⟧ ≤ ⋁_{s ∈ S} ⟦a = a⟧ = ‖a‖\text{ in}\\
    &⟦a = a'⟧∧⟦a' ∈ m⟧ = ⋁_{s ∈ S} ⟦a = a'⟧∧⟦a' = m(s)⟧ ≤ ⋁_{s ∈ S} ⟦a = m(s)⟧ = ⟦a ∈ m⟧\text.
  \end{align*}

  
  TODO: končaj dokaz
\end{proof}


TODO: primeri konstrukcij: produkt, potenčna \(ℒ\)-množica, vsota?, še kaj? Če
rata tudi odvisna vsota ali produkt.

\subsubsection{Interni jezik}

Oglejmo si ta interni jezik bolj natančno. Uvedimo končno oznako za
interpretacijo logičnih formul kot odprte množice, t.~j.~za formulo \(φ\)
označimo njeno interpretacijo kot \(⟦φ⟧\). Ta je namerno enaka gornjima dvema,
saj bomo videli, da sta zares to sestavna dela interpretacije v splošnem.
Enakost lahko interpretiramo kar kot enakost v \(ℒ\)-množici, torej
\(⟦x = y⟧ = ⟦x = y⟧\). Za morfizme moramo narediti nekaj čudnega, ker kot rečeno
``\(f(a)\)'' ne zares obstaja. Naj bo \(f : A ↬ B\) morfizem in \(φ\) formula s
prosto spremenljivko tipa \(B\), potem naj bo
\(⟦φ(f(a))⟧ = ⋁_{b ∈ B}⟦b = f(a)⟧∧⟦φ(b)⟧\). Tako se potem \(b = f(a)\)
interpretira kot \(⋁_{b' ∈ B}⟦b' = f(a)⟧∧⟦b = b'⟧\), kar je pa enako
\(⟦b = f(a)⟧\), tako da smo res poenotili gornja dva zapisa.

TODO: končaj ostalo



\subsubsection{Polne \(ℒ\)-množice}


Prej smo že omenili, da lahko iz globalnih lokalnih elementov rekonstruiramo
snop, vendar je ta konstrukcija komplicirana, poleg tega pa potem delamo z
nekimi kvocienti, kar nikoli ni prijetno. Tako bi želeli, da bi naše
\(ℒ\)-množice kar dopolnili še z vsemi ostalimi elementi snopa. Vemo, da imamo
za to dovolj informacij, saj je vsak element zožitev enega od globalnih
lokalnih, je pa vseeno izziv kako identificirati zožitve, ki se ujemajo.

% TODO: reword
% Trik, ki ga bomo uporabili smo že srečali pri motivaciji za definicijo
% \(ℒ\)-preslikav, namreč, da lahko element snopa \(f\) primerjamo z vsemi
% globalnimi lokalnimi elementi, torej da dobimo funkcijo iz \(ℒ\)-množice v okvir
% \(ℒ\). Ta konstrukcija v snopih enolično določa elemente, torej če sta
% \(f ∈ F(U)\) in \(g ∈ F(V)\), in se njune primerjave ujemata na vseh globalnih
% lokalnih elementih, se v posebnem tudi ujemata z neko razširitvijo \(f\) (ki jo
% označimo \(f'\)), torej velja \(f{\res V} = f'{\res{U∩V}} = g{\res U}\), kar pa
% pomeni, da sta \(f\) in \(g\) skladna. Potem pa nam vsaka primerjava definira
% skladno družino, ki jo lahko zlepimo v enoličen element snopa.

% Spomnimo se pa, da so take funkcije natanko podobjekti, in če je element
% podobjekta enolično določen, mu lahko pravimo enojec, oziroma podenojec, ker ta
% element ne obstaja nujno med globalnimi lokalnimi elementi. Vendar pa kljub
% temu, da so te podenojci lahko \quot{prazni}, imajo dovolj zanimivo strukturo,
% da iz njih lahko rekonstruiramo celoten snop.

% % TODO: reword
% Naj bo \(F\) snop nad \(ℒ\). Potem lahko za \(m ∈ F(U)\) definiramo enojec
% \(⟦a ∈ ⟨m⟩⟧ ≔ ⟦a = m⟧\), kjer je \(a ∈ F(V), V ∈ ℒ\).
% Na enojcih lahko definiramo tudi \(⟦⟨m⟩ = ⟨n⟩⟧ ≔ ⟦m = n⟧\).
% Snop \(F\) lahko sedaj rekonstruiramo iz njegovih enojcev.
% Podobno bomo storili za \(ℒ\)-množice.

\begin{definicija}
  \emph{(Pod)enojec} na \(ℒ\)-množici \(A\) je \(ℒ\)-podmnožica \(S ⊑ A\), za katero velja
  \[ \for{a,b ∈ S}{⟦a ∈ S⟧ ∧ ⟦b ∈ S⟧ ≤ ⟦a = b⟧}\text. \]
\end{definicija}
\begin{opomba}
  Če razpišemo definicijo \(ℒ\)-podmnožic, dobimo da so enojci preslikave, ki poleg
  gornjemu pogoju zadoščajo zgolj še drugi pogoj \(ℒ\)-podmnožic, torej
  \[ \for{a,b ∈ A}{⟦a = b⟧ ∧ ⟦b ∈ S⟧ ≤ ⟦a ∈ S⟧}\text. \]
\end{opomba}

V internem jeziku to res pravi, da ima podenojec kvečjemu en element.
\begin{opomba}
  V literaturi se tem preslikavam reče kar enojci, saj enolično določajo
  delno definirane elemente, in se bomo tega držali tudi mi. Poleg tega se za
  enojce ponavadi uporablja grške črke \(σ\), \(ρ\), in \(τ\).
\end{opomba}

\begin{konstrukcija}
  Za vsak \(m ∈ A\) lahko tvorimo enojec \(\s m : A → ℒ\), s predpisom
  \(a ↦ ⟦a = m⟧\).
\end{konstrukcija}
\begin{dokaz}
  Preslikava \(\s m\) je res enojec, saj velja
  \[ ⟦a ∈ \s m⟧∧⟦b ∈ \s m⟧ = ⟦a = m⟧∧⟦m = b⟧ ≤ ⟦a = b⟧ \]
  in
  \[ ⟦a = b⟧∧⟦b ∈ \s m⟧ = ⟦a = b⟧∧⟦b = m⟧ ≤ ⟦a = m⟧ = ⟦a ∈ \s m⟧\text.\qedhere \]
\end{dokaz}

\begin{konstrukcija}
  Množico enojcev \(A\) z relacijo \(⟦ρ = τ⟧ ≔ ⋁_{a ∈ A} ρ(a)∧τ(a)\)
  tvori \(ℒ\)-množico \(σ(A)\).
\end{konstrukcija}
\begin{proof}
  Relacija je očitno simetrična, tako da si poglejmo le tranzitivnost:
  \begin{align*}
    ⟦ρ = τ⟧∧⟦τ = θ⟧
    &= \p{⋁_{a ∈ A} ρ(a)∧τ(a)} ∧ \p{⋁_{a ∈ A} τ(a)∧θ(a)}\\
    &= ⋁_{a,a' ∈ A} ρ(a)∧τ(a)∧τ(a')∧θ(a')\\
    &≤ ⋁_{a,a' ∈ A} ρ(a)∧⟦a = a'⟧∧θ(a')\\
    &≤ ⋁_{a ∈ A} ρ(a)∧θ(a) = ⟦ρ = θ⟧\text,
  \end{align*}
  kjer v drugi enakosti uporabimo, da je \(ℒ\) okvir.
\end{proof}

\begin{konstrukcija}\label{lem:image}
  Vsakemu \(ℒ\)-morfizmu \(f : A ↬ B\), \(a ∈ A\), in \(b ∈ B\) lahko priredimo
  \begin{enumerate}
  \item \(ℒ\)-podmnožico \(f⁻¹(b) ⊑ A\), definirano z \(x ↦ ⟦b = f(x)⟧\),
    imenovano \emph{praslika} in
  \item enojec \(f(a) ⊑ B\), definiran z \(y ↦ ⟦y = f(a)⟧\), imenovan \emph{slika}.
  \end{enumerate}
\end{konstrukcija}
\begin{dokaz}
  V obeh primerih prvi aksiom drži zaradi celovitosti, drugi pa zaradi
  skladnosti morfizma z relacijo na ustrezni \(ℒ\)-množici.
\end{dokaz}

\begin{lema}\label{lem:swap}
  Za \(ℒ\)-podmnožico \(φ : A → ℒ\) velja \({φ(a)∧⟦a = b⟧ = φ(b)∧⟦a = b⟧}\).
\end{lema}
\begin{lema}\label{lem:subst}
  Za \(ℒ\)-podmnožico \(φ : A → ℒ\) velja \({φ(a) = ⋁_{x ∈ A} φ(x)∧⟦x = a⟧}\).
  V posebnem za \(ℒ\)-morfizem \(f : A ↬ B\) velja \(⟦b = f(a)⟧ = ⋁_{x ∈ A} ⟦b = f(x)⟧∧⟦x = a⟧\).
\end{lema}
\begin{dokaz}
  Ker je \({φ(a) = φ(a)∧⟦a = a⟧}\) velja \(φ(a) ≤ ⋁_{x ∈ A} φ(x)∧⟦x = a⟧\),
  obratna neenakost pa sledi iz drugega aksioma \(ℒ\)-podmnožic.
\end{dokaz}

\begin{lema}\label{lem:singunit}
  Za \(m,n ∈ A\) in \(τ ∈ σ(A)\) veljajo naslednje enakosti:
  \begin{enumerate}
  \item \(⟦\s m ∈ \s τ⟧ = ⟦\s m = τ⟧ = τ(m)\)
  \item \(⟦\s m = \s n⟧ = ⟦m = n⟧\)
  \item \(⟦n ∈ \s m⟧ = ⟦m ∈ \s n⟧\)
  \item \(⟦m = n⟧ = ⋁_{τ ∈ σ(A)} τ(m)∧τ(n)\)
  \end{enumerate}
\end{lema}
\begin{dokaz}
  Prvi enačaj velja po definiciji, tako da razpišemo zgolj drugega:
  \begin{equation*}
    ⟦\s m = τ⟧ = ⋁_{a ∈ A} ⟦a ∈ \s m⟧∧τ(a) = ⋁_{a ∈ A} ⟦m = a⟧∧τ(a) = τ(m)\text,
  \end{equation*}
  kjer smo za zadnjo enakost uporabili gornjo lemo na \(ℒ\)-podmnožici \(τ\).

  Enakost v drugi točki sledi iz \(\i{\s m = \s n} = ⟦m ∈ \s n⟧ = ⟦m = n⟧\),
  tretja točka pa sledi po definiciji iz simetrčnosti relacije.

  Oglejmo si še zadnjo točko. Neenakost \(≥\) očitno sledi iz aksiomov enojcev,
  tako da moramo preveriti zgolj drugo smer:
  \begin{equation*}
    ⟦m = n⟧ = ⟦m = m⟧∧⟦m = n⟧ = ⟦m ∈ \s m⟧∧⟦n ∈ \s m⟧ ≤ ⋁_{τ ∈ σ(A)} τ(m)∧τ(n)\text.\qedhere
  \end{equation*}
\end{dokaz}

% TODO: rewrite
% Kot smo rekli na začetku podrazdelka, nam vsak enojec na \(F'\) enolično določa
% element snopa \(F\). Prav tako pa enojci na \(F\) enolično določajo elemente
% \(F\). Če torej želimo dopolniti \(ℒ\)-množico do celega snopa, moramo vzeti
% njeno množico enojcev, oziroma bolj natančno, so polne \(ℒ\)-množice take, kjer
% nam enojci ne predstavljajo nobenih novih elementov. % nobenih drugih elementov
%                                 % kot elementov \(ℒ\)-množice same.

\begin{definicija}
  \(ℒ\)-množica \(A\) je \emph{polna}, kadar je preslikava množic \(m ↦ \s m\)
  bijekcija. Polno podkategorijo polnih \(ℒ\)-množic označimo s
  \(\cat{CSet}(ℒ)\).
\end{definicija}
% NOTE: {-} definira idempotentno monado. To mi avtomatsko da naslednjih par
% rezultatov (specifično do izreka da so polne ℒ-množice refleksivna
% podkategorija).
\begin{lema}
  \(ℒ\)-množica \(σ(A)\) je polna.
\end{lema}
\begin{dokaz}
  Pokazati moramo, da je preslikava \(τ ↦ \s τ\) bijekcija.
  % TODO: reword
  Injektivnost:
  Denimo, da velja \(\s τ = \s ρ\). Potem velja
  \begin{equation*}
    τ(a) = \i{\s a ∈ \s τ} = \i{\s a ∈ \s ρ} = ρ(a)\text,
  \end{equation*}
  torej je preslikava injektivna.
  % NOTE: to je inverz enote (in je množenje).
  Naj bo sedaj \(Σ ∈ σ(σ(A))\). Definirajmo \(τ(a) ≔ Σ(\s a)\).
  To je enojec, saj velja
  \begin{align*}
    τ(a)∧τ(b) &= Σ(\s a)∧Σ(\s b) ≤ ⟦\s a = \s b⟧ = ⟦a = b⟧\text{ in}\\
    ⟦a = b⟧∧τ(b) &= ⟦a = b⟧∧Σ(\s b) = ⟦\s a = \s b⟧∧Σ(\s b) ≤ Σ(\s a) = τ(a)\text.
  \end{align*}

  Pokažimo še, da je \(Σ = \s τ\).
  \begin{align*}
    \i{ρ ∈ \s τ}
    &= ⟦τ = ρ⟧ = ⋁_{a ∈ A} τ(a)∧ρ(a) = ⋁_{a ∈ A} Σ(\s a)∧⟦ρ = \s a⟧\\
    &= ⋁_{a ∈ A} Σ(ρ)∧⟦ρ = \s a⟧ = Σ(ρ)∧‖ρ‖ = Σ(ρ)\text,
  \end{align*}
  kjer za tretjo enakost uporabimo, da lahko pod enakostjo menjamo argumente
  \mbox{\(ℒ\)-podmnožicam}. Sledi, da za vsak enojec v \(σ(σ(A))\) obstaja natanko
  en enojec v \(σ(A)\), ki se vanj slika, tako da je preslikava \(σ\) res
  bijekcija, in je \(σ(A)\) polna.
\end{dokaz}

\begin{trditev}
  Naj bo \(f : A ↬ B \) in \(B\) polna \(ℒ\)-množica. Tedaj obstaja preslikava
  \(φ : A → B\), za katero velja \(⟦b = f(a)⟧ = ⟦b =_B φ(a)⟧\).
  Poleg tega velja tudi \(⟦a = a'⟧ ≤ ⟦φ(a) = φ(a')⟧\), in enakost drži kadar je \(a = a'\).
\end{trditev}
\begin{dokaz}
  Za vsak \(a ∈ A\) je \(b ↦ ⟦b = f(a)⟧\) enojec, torej po polnosti \(B\)
  natanko določa en element \(B\), ki ga označimo \(φ(a)\). To definira
  preslikavo \(φ\).

  TODO: neenakosti?
\end{dokaz}
\begin{posledica}
  Kategorija polnih \(ℒ\)-množic je ekvivalentna kategoriji, katere
  \catdef
    {so polne \(ℒ\)-množice in}
    {so funkcije \(f : A → B\), ki zadoščajo sledečima pogojema:
      \begin{itemize}
      \item \(⟦a = a'⟧ ≤ ⟦f(a) = f(a')⟧\), in
      \item \(⟦a = a⟧ = ⟦f(a) = f(a)⟧\).
      \end{itemize}}
\end{posledica}

\begin{izrek}\label{th:sigmaiso}
  \(ℒ\)-množica \(σ(A)\) je izomorfna \(A\).
\end{izrek}
\begin{dokaz}
  % NOTE: f je enota monade σ, če je g njen inverz, kaj je njena povezava z
  % množenjem? Plus lahko spustimo pol dokazov, da je f morfizem.
  Definirajmo preslikavo \(⟦τ = η(a)⟧ ≔ τ(a)\).
  Očitno je skladna z relacijama, tako da moramo preveriti zgolj
  enoličnost in celovitost. Enoličnost sledi iz neenakosti
  \(τ(a)∧ρ(a) ≤ ⟦τ = ρ⟧\), celovitost pa iz enakosti
  \[ ⟦a = a⟧ = ⟦\s a = \s a⟧ = ⋁_{τ ∈ σ(A)} ⟦\s a = τ⟧ = ⋁_{τ ∈ σ(A)} τ(a)\text. \]
  
  Preveriti moramo torej le še, da je bijekcija. Injektivna je očitno, saj to
  sledi iz definicije enojca, surjektivnost pa sledi iz
  \(⟦\s a = η(a)⟧ = \i{a ∈ \s a} = ‖a‖\).
\end{dokaz}
\begin{posledica}
  Kategorija \(ℒ\)-množic je ekvivalentna kategoriji polnih \(ℒ\)-množic.
\end{posledica}

\begin{lema}
  Polne \(ℒ\)-množice imajo operator zožitve, t.~j. za vsak \(m ∈ A\) in
  \(U ∈ ℒ\) obstaja \(m{\res U} ∈ A\), tako da velja \(⟦a = m{\res U}⟧ = ⟦a = m⟧∧U\).
  V posebnem torej tudi velja \(‖m{\res U}‖ = ‖m‖∧U\) in \(m{\res U\res V} = m{\res{U∧V}}\).
\end{lema}
\begin{dokaz}
  Tvorimo kar \(τ(a) = ⟦a = m⟧∧U\). To je enojec, saj
  \begin{align*}
    τ(a)∧τ(b) &= ⟦a = m⟧∧U∧⟦b = m⟧∧U ≤ ⟦a = b⟧\text{ in}\\
    ⟦a = b⟧∧τ(b) &= ⟦a = b⟧∧⟦b = m⟧∧U ≤ ⟦a = m⟧∧U = τ(a)\text.
  \end{align*}
  Ker je \(A\) polna, ta ustreza nekemu elementu, ki mu lahko rečemo
  \(m{\res U}\), zanj pa očitno velja željena enakost
  \begin{equation*}
    ⟦a = m{\res U}⟧ = ⟦\s a = τ⟧ = τ(a) = ⟦a = m⟧∧U\text. \qedhere
  \end{equation*}
\end{dokaz}
\begin{posledica}
  Za \(m ∈ A\) in \(U ∈ ℒ\) velja \(\i{n ∈ {\s m}{\res U}} = \i{n ∈ \s m}∧U\).
\end{posledica}
\begin{posledica}
  Za \(τ ∈ σ(A)\) in \(U ∈ ℒ\) velja \({\s τ}{\res U} = \s{τ{\res U}}\).
\end{posledica}

TODO: enoličnost manjka v izreku in dokazu.
\begin{lema}
  Polne \(ℒ\)-množice imajo lepljenje skladnih družin, t.~j. za vsako družino
  \(mᵢ ∈ A\), za katero velja \(mᵢ{\res{Uⱼ}} = mⱼ{\res{Uᵢ}}\), kjer je \(Uᵢ ≔ ‖mᵢ‖\),
  obstaja tak \(m ∈ A\), da je \(m{\res{Uᵢ}} = mᵢ\).
  %\(mᵢ ∈ A\) za katero velja \(⟦mᵢ = mⱼ⟧ = ‖mᵢ‖∧‖mⱼ‖\) obstaja nek \(m ∈ A\),
  %tako da je \(⟦m = mᵢ⟧ = ‖mᵢ‖\) in \(‖m‖ = ⋁ᵢ‖mᵢ‖\).
\end{lema}
\begin{dokaz}
  Naj bodo \(mᵢ\) taki in tvorimo preslikavo \(τ(a) = ⋁ᵢ⟦a = mᵢ⟧\).
  Iz skladnosti družine sledi, da velja
  \[ ⟦a = mᵢ⟧∧Uⱼ = ⟦a = mᵢ{\res{Uⱼ}}⟧ = ⟦a = mⱼ{\res{Uᵢ}}⟧ = ⟦a = mⱼ⟧∧Uᵢ\text. \]
  
  Preslikava \(τ\) je enojec, saj velja
  \begin{align*}
    ⟦a = b⟧∧τ(b)
    &= ⋁ᵢ⟦a = b⟧∧⟦b = mᵢ⟧ ≤ ⋁ᵢ⟦a = mᵢ⟧ = τ(a)\text{ in}\\
    τ(a)∧τ(b)
    &= ⋁ᵢⱼ⟦a = mᵢ⟧∧⟦b = mⱼ⟧\\
    &= ⋁ᵢⱼ⟦a = mᵢ⟧∧Uᵢ∧⟦b = mⱼ⟧∧Uⱼ\\
    &= ⋁ᵢⱼ⟦a = mᵢ⟧∧Uⱼ∧⟦b = mⱼ⟧∧Uᵢ\\
    &= ⋁ᵢ⟦a = mᵢ⟧∧⟦b = mᵢ⟧ ≤ ⟦a = b⟧\text,
  \end{align*}
  torej ustreza nekemu \(m ∈ A\). Po zgornji lemi velja
  \begin{equation*}
    ⟦mᵢ = m{\res{Uᵢ}}⟧ = ⟦mᵢ = m⟧∧Uᵢ = \i{mᵢ ∈ \s m}∧Uᵢ = \textstyle⋁\!ⱼ⟦mᵢ = mⱼ⟧∧Uᵢ = Uᵢ\text,
  \end{equation*}
  torej se ujemata na celotnem razponu in sta enaka.

  Razpon \(m\) je \(‖m‖ = \i{m ∈ \s m} = ⋁ᵢ⟦m = mᵢ⟧ = ⋁ᵢUᵢ\), kar mora veljati za vsako
  amalgamacijo družine \(mᵢ\), tako da je \(m\) tudi enoličen.
  NOTE: Kaj? To ni dokaz enoličnosti…
\end{dokaz}

% \begin{konstrukcija}
%   Naj bo \(A\) \(ℒ\)-množica. Potem ji lahko priredimo snop
%   \[ Θ(A)(U) = \set{τ ∈ σ(A)}{‖τ‖ = U}\text. \]
%   Morfizmu \(f : A ↬ B\) \(ℒ\)-množic priredimo preslikavo
%   % NOTE: to je morphism action σ, torej Θ je I∘σ, kjer I predstavlja renotation
%   % polne ℒ-množice v snop
%   \[ Θ(f)_U(τ)(b) ≔ ρ(b) = ⋁_{a ∈ A}⟦b = f(a)⟧∧τ(a)\text. \]
%   To je res enojec na \(B\), saj velja
%   \begin{align*}
%     ⟦b' = b⟧∧ρ(b)
%     &= ⋁_{a ∈ A}⟦b' = b⟧∧⟦b = f(a)⟧ ≤ ⋁_{a ∈ A}⟦b' = f(a)⟧ = ρ(b')\text{ in}\\
%     ρ(b)∧ρ(b')
%     &= ⋁_{a,a' ∈ A} ⟦b = f(a)⟧∧τ(a)∧τ(a')∧⟦b' = f(a')⟧\\
%     &≤ ⋁_{a,a' ∈ A} ⟦b = f(a)⟧∧⟦a = a'⟧∧⟦b' = f(a')⟧\\
%     &≤ ⋁_{a' ∈ A} ⟦b = f(a')⟧∧⟦b' = f(a')⟧ ≤ ⟦b = b'⟧\text.
%   \end{align*}
%   To definira funktor med kategorijama \(\cat{Set}(ℒ)\) in \(\cat{Sh}(ℒ)\).
% \end{konstrukcija}

% \begin{konstrukcija}
%   Naj bo \(P\) predsnop. Potem mu lahko priredimo \(ℒ\)-množico
%   \(Γ(P) ≔ ∑_{U ∈ ℒ} P(U)\) z relacijo
%   % NOTE: ta je pa zgolj renotation predsnopa v ℒ-množico, tako da je od
%   % adjunkcije samo σ.
%   \[ ⟦\p{U, f} = \p{V, g}⟧ ≔ ⋁\set{W ∈ ℒ}{W≤U∧V \text{ in } f\res W = g\res W}\text. \]
%   % TODO: dokaži polnost
%   Morfizmu predsnopov \(α : P ⇒ Q\) priredimo preslikavo \(Γ(α)(U, f) ≔ α_U(f)\).
%   To definira funktor med kategorijama \(\cat{PSh}(ℒ)\) in \(\cat{Set}(ℒ)\).
% \end{konstrukcija}

% \begin{trditev}
%   Funktor \(Γ\) je levi adjunkt funktorju \(Θ\).
% \end{trditev}
% \begin{dokaz}
%   % Naj bo \(φ : Θ(A) → P\) morfizem predsnopov. Definirati želimo morfizem
%   % \mbox{\(ℒ\)-množic} \(A ↬ Γ(P)\).
%   % Elementoma \(a ∈ A\) z \(‖a‖ = U\) in \(\p{V, f} ∈ Γ(P)\) lahko priredimo
%   % \(⟦f = φ_U(σₐ)⟧\).
%   % To je očitno morfizem \(ℒ\)-množic.
  
%   % Obratno, naj bo \(φ : A ↬ Γ(P)\) morfizem \(ℒ\)-množic.
%   % Tedaj elementu \(τ ∈ Θ(A)(U)\) priredimo element \(\).
%   % To spet očitno definira morfizem snopov, tako da sta funktorja \(Θ\) in \(Γ\)
%   % res adjungirana in definirata ekvivalenco željenih kategorij.
%   % % TODO: correct this detail
%   % Naj bo \(φ : P ⇒ Θ(A)\). Potem \(⟦a = f\p{U, p}⟧ ≔ φ_U(p)(a)\) definira
%   % morfizem \(ℒ\)-množic \(Γ(P) ↬ A\), saj velja \(φ_U(p)(a) = ⟦σₐ = φ_U(p)⟧\).
 
%   % Obratno, naj bo \(f : Γ(P) ↬ A\). Morfizem predsnopov \(φ : P ⇒ Θ(A)\)
%   % konstruiramo kot \(φ_U(p) ≔ ⟦- = f\p{U, p}⟧\), ki je enojec na \(A\).
%   % Razpon tega enojca je pa \(⋁_{a ∈ A} ⟦a = f\p{U, p}⟧ = ‖\p{U,p}‖ = U\).

%   % Ti prireditvi sta si očitno inverzni, tako da definirata adjunkcijo \(Γ ⊣ Θ\).
%   Koenota adjunkcije je izomorfizem iz izreka \ref{th:sigmaiso},
%   enota pa slika \(p ∈ P(U)\) v \(σ_{(U,p)}\). To je naravna
%   transformacija, saj \(σ\) \quot{komutira} z zožitvami.
% \end{dokaz}

% \begin{izrek}
%   Kategorija polnih \(ℒ\)-množic je ekvivalentna kategoriji snopov nad \(ℒ\).
% \end{izrek}
% \begin{dokaz}
%   Če funktorja \(Γ\) in \(Θ\) zožimo na dani kategoriji, sta si spet
%   adjungirana, tako da moramo zgolj pokazati, da sta enota in koenota
%   izomorfizma.

%   Koenota je že izomorfizem po \ref{th:sigmaiso}, tako da moramo preveriti zgolj
%   enoto.

%   Naj bo \(F\) snop. Potem \(η_U : F(U) → ΘΓ(F)(U)\) slika \(f ↦ σ_{(U,f)}\).
%   Ker je \(F\) snop je \(ℒ\)-množica \(Γ(F)\) že polna, tako da so elementi
%   \(ΘΓ(F)(U)\) že natanko elementi \(Γ(F)\) z razponom \(U\), ki so pa natanko
%   elementi \(F(U)\), torej je tudi enota izomorfizem.
% \end{dokaz}

%%% Local Variables:
%%% TeX-master: "main"
%%% End:
